package com.example.demo;

import javax.transaction.Transactional;

import org.junit.jupiter.api.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.ModelAndViewAssert;

import project.transito.models.AgenteTransito;
import project.transito.models.Historial;
import project.transito.models.Via;
import project.transito.service.AgenteTransitoService;
import project.transito.service.HistoricoService;
import project.transito.service.ViaService;

@RunWith(SpringRunner.class)
@SpringBootTest
@ContextConfiguration(classes = {ConfigurationSpring.class})
class ProjectTransitoApplicationTests {
	
	
	@Autowired
	private ViaService viaService;
	
	@Autowired
	private AgenteTransitoService agenteTransitoService;
	
	@Autowired
	private HistoricoService historicoService;
	
	
	
	//---- metodos de prueba de la via-----//
	
	@Test
	public void addVia()
	{
		Via via = new Via();
		via.setCalleCarrera("calle");
		via.setNivelCongestion(45.2);
		via.setTipo("Autopista");
		via.setNumero(100);
		
		viaService.add(via);
		
		
	}
	
	@Test
	public void deleteVia()
	{
		viaService.delete(1);
	}
	
	@Test
	public void updateVia()
	{
		Via via = new Via();
		via.setCalleCarrera("carrera");
		via.setNivelCongestion(30.2);
		via.setTipo("Carrete secundaria");
		via.setNumero(99);
		via.setIdentificador(2);
		
		viaService.update(via);	
	}
	
	@Test
	@Transactional
	public void searchVia()
	{
		
		System.out.println(viaService.search(2));
		
	}
	
	@Test
	@Transactional
	public void listVia()
	{
		System.out.println(viaService.list());
	}
	
	@Test
	@Transactional
	public void listViaApto()
	{
		System.out.println(viaService.listViaApto());
	}
	
	//---- metodos de prueba del agente de transito------//
	
	@Test
	public void addAgente()
	{
		Via via = viaService.search(3);
		AgenteTransito agenteTransito = new AgenteTransito();
		agenteTransito.setYearExperience(22.5);
		agenteTransito.setCodigo(1020);
		agenteTransito.setCodigoTransito("ab85dps");
		agenteTransito.setNombre("jeisson");
		agenteTransito.setVia(via);
		
		agenteTransitoService.add(agenteTransito);
	
		
	}
	
	@Test
	public void deleteAgente()
	{
		agenteTransitoService.delete(101010);
		
	}
	
	@Test
	public void updateAgente()
	{
		
		Via via = viaService.search(2);
		AgenteTransito agenteTransito = new AgenteTransito();
		agenteTransito.setYearExperience(11.5);
		agenteTransito.setCodigo(101010);
		agenteTransito.setCodigoTransito("ab84s");
		agenteTransito.setNombre("carlos");
		agenteTransito.setVia(via);
		
		agenteTransitoService.update(agenteTransito);	
	}
	
	@Test
	@Transactional
	public void searchAgente()
	{
		
		System.out.println(agenteTransitoService.search(101010));
		
	}
	
	@Test
	@Transactional
	public void listAgente()
	{
		System.out.println(agenteTransitoService.list());
	}
	
	@Test
	@Transactional
	public void valideteCodeT()
	{
		System.out.println(agenteTransitoService.validateCodeT("abc12"));
	}
	
	//----metodos de prueba del historial----//
	
	@Test
	@Transactional 
	public void addHistorico()
	{
		Historial historial  = new Historial();
		historial.setAgenteTransito(agenteTransitoService.search(12));
		historicoService.add(historial);

	}
	

}
